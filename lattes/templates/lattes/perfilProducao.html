{% extends 'lattes/layout.html' %}

{% block main %}
<div id="grid-main">
    <canvas id="ChartAno"></canvas>
    <canvas id="ChartBibligrafico"></canvas>
    <canvas id="ChartTecnico"></canvas>
    <canvas id="ChartArtistico"></canvas>
    <canvas id="ChartEvento"></canvas>
    <canvas id="ChartOrientacao"></canvas>
</div>
<script>
    var ctx = document.getElementById('ChartAno');
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: {{ anos }},
        datasets: [{
            label: '# de Produção',
            data: {{ totalAno }},
        backgroundColor: 'rgba(54, 162, 235, 0.2)',
        borderColor: 'rgba(54, 162, 235, 1)',
        borderWidth: 1
            }]
        },
        options: {
        tooltips: {
            callbacks: {
                title: function (tooltipItems, data) {
                    return data.labels[tooltipItems[0].index]
                }
            }
        },
        title: { display: true, text: 'Distribuição de produção por ano' },
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }],
            xAxes: [{
                ticks: {
                    autoSkipPadding: 11,
                    maxRotation: 90,
                    minRotation: 0
                }
            }]
        }
    }
    });
    Chart.scaleService.updateScaleDefaults('category', {
        ticks: {
            callback: function (tick) {

                return tick.substring(0, 15) + "...";
            }
        }
    });
    new Chart(document.getElementById('ChartBibligrafico'), {
        type: 'bar',
        data: {
            labels: {% autoescape off %}{{ tiposB }}{% endautoescape %},
        datasets: [{
            label: '# de Produção',
            data: {{ totalTipoB }},
        backgroundColor: 'rgba(54, 162, 235, 0.2)',
        borderColor: 'rgba(54, 162, 235, 1)',
        borderWidth: 1
            }]
        },
        options: {
        title: { display: true, text: 'Distribuição por tipo de produção bibliográfico' },
    }
    });
    new Chart(document.getElementById('ChartTecnico'), {
        type: 'bar',
        data: {
            labels: {% autoescape off %}{{ tiposT }}{% endautoescape %},
        datasets: [{
            label: '# de Produção',
            data: {{ totalTipoT }},
        backgroundColor: 'rgba(54, 162, 235, 0.2)',
        borderColor: 'rgba(54, 162, 235, 1)',
        borderWidth: 1
            }]
        },
        options: {
        title: { display: true, text: 'Distribuição por tipo de produção técnica' },
    }
    });
    new Chart(document.getElementById('ChartOrientacao'), {
        type: 'bar',
        data: {
            labels: {% autoescape off %}{{ tiposO }}{% endautoescape %},
        datasets: [{
            label: '# de Produção',
            data: {{ totalTipoO }},
            backgroundColor: 'rgba(54, 162, 235, 0.2)',
            borderColor: 'rgba(54, 162, 235, 1)',
            borderWidth: 1
            }],
        },
        options: {
        title: { display: true, text: 'Distribuição por tipo de produção orientação em andamento' },
    }
    });
    new Chart(document.getElementById('ChartArtistico'), {
        type: 'bar',
        data: {
            labels: {% autoescape off %}{{ tiposA }}{% endautoescape %},
        datasets: [{
            label: '# de Produção',
            data: {{ totalTipoA }},
        backgroundColor: 'rgba(54, 162, 235, 0.2)',
        borderColor: 'rgba(54, 162, 235, 1)',
        borderWidth: 1
            }]
        },
        options: {
        title: { display: true, text: 'Distribuição por tipo de produção artística/cultural' },
    }
    });
    new Chart(document.getElementById('ChartEvento'), {
        type: 'bar',
        data: {
            labels: {% autoescape off %}{{ tiposE }}{% endautoescape %},
        datasets: [{
            label: '# de Produção',
            data: {{ totalTipoE }},
        backgroundColor: 'rgba(54, 162, 235, 0.2)',
        borderColor: 'rgba(54, 162, 235, 1)',
        borderWidth: 1
            }]
        },
        options: {
        title: { display: true, text: 'Distribuição por tipo de produção banca, evento ou outro tipo de produção' },
    }
    });
</script>
{% endblock %}
{% block aside %}
<h2><i class="fas fa-search"></i> Filtros</h2>
<form method="GET">
    <div id="filtroTitulo">
        <div class="drop-bnt">
            <h3>Titulo <i class="fas fa-caret-down"></i></h3>
        </div>
        <div class="wrapper">
            <p>Titulo:{{producoes_filtradas.form.titulo__contains}}</p>
        </div>
    </div>
    <div id="filtroTipo">
        <div class="drop-bnt">
            <h3>Tipo <i class="fa fa-caret-down"></i></h3>
        </div>
        <div class="wrapper">
            <p>Tipo:{{producoes_filtradas.form.tipo__contains}}</p>
        </div>
    </div>
    <div id="filtroAno">
        <div class="drop-bnt">
            <h3>Ano Produção <i class="fas fa-caret-down"></i></h3>
        </div>
        <div class="wrapper">
            <p>Ano partir de: {{producoes_filtradas.form.ano__gte}} até:
                {{producoes_filtradas.form.ano__lte}}</p>
        </div>
    </div>
    <div id="filtroInformadoPor">
        <div class="drop-bnt">
            <h3>Informado Por <i class="fas fa-caret-down"></i></h3>
        </div>
        <div class="wrapper">
            <p>informado por:{{producoes_filtradas.form.informadoPor__contains}}</p>
        </div>
    </div>
    <input type="submit" value="Buscar">
    <a href="?" class="botao">Limpar</a>
</form>
<script>
    function f(element, index) {
        element.onclick = (() => {
            wrapper[index].classList.toggle("show");
        });
    }
    const list = document.querySelectorAll('.drop-bnt').forEach(f);
    const wrapper = document.querySelectorAll(".wrapper");
</script>
{% endblock %}